<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Full Chess.com-style Chess</title>
<style>
body {
    margin: 0;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    background-color: #2b2b2b;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
    color: #fff;
}
#container { display: flex; flex-wrap: wrap; justify-content: center; margin-top: 20px; }
#chessboard { display: grid; grid-template-columns: repeat(8, 64px); grid-template-rows: repeat(8, 64px); border: 2px solid #333; position: relative; box-shadow: 0 0 10px rgba(0,0,0,0.5);}
.square { width: 64px; height: 64px; display: flex; justify-content: center; align-items: center; transition: background 0.2s;}
.white { background: #f0d9b5; }
.black { background: #b58863; }
.highlight { background: rgba(255,255,0,0.5) !important; }
.hover-highlight { background: rgba(255,165,0,0.5) !important; }
.last-move { background: rgba(0,153,255,0.4) !important; }
.in-check { background: rgba(255,0,0,0.6) !important; }
.piece { position: absolute; width: 64px; height: 64px; cursor: grab; transition: top 0.2s, left 0.2s, transform 0.2s;}
.piece:hover { transform: scale(1.1); }
#promotion-overlay { position: absolute; display: none; background: #333; border: 2px solid #666; z-index: 200; padding: 5px; display: flex; border-radius: 8px;}
.promo-piece { width: 64px; height: 64px; cursor: pointer; margin: 2px; }
#side-panel { display: flex; flex-direction: column; margin-left: 20px; max-width: 220px; }
#history { width: 100%; max-height: 300px; overflow-y: auto; background: #1e1e1e; border-radius: 8px; margin-bottom: 10px; padding: 10px;}
#history h3 { text-align: center; margin-top: 0; color: #00bfff; }
#history ol { padding-left: 20px; }
#history li { margin-bottom: 4px; color: #fff; }
#controls { display: flex; justify-content: space-between; margin-bottom: 10px; }
button { background-color: #00bfff; border: none; color: #fff; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
button:hover { background-color: #0099cc; }
#timers { display: flex; justify-content: space-between; margin-bottom: 10px; }
.timer { background: #1e1e1e; padding: 5px 10px; border-radius: 4px; text-align: center; }
@media (max-width: 700px){
    #container { flex-direction: column; align-items: center; }
    #side-panel { margin-left: 0; margin-top: 20px; }
}
</style>
</head>
<body>

<div id="container">
    <div id="chessboard"></div>
    <div id="side-panel">
        <div id="timers">
            <div class="timer" id="whiteTimer">White: 10:00</div>
            <div class="timer" id="blackTimer">Black: 10:00</div>
        </div>
        <div id="controls">
            <button id="undoBtn">Undo</button>
            <button id="redoBtn">Redo</button>
        </div>
        <div id="history"><h3>Move History</h3><ol id="moves"></ol></div>
    </div>
</div>
<div id="promotion-overlay"></div>

<script>
// --- Setup ---
const boardEl = document.getElementById('chessboard');
const overlay = document.getElementById('promotion-overlay');
const movesList = document.getElementById('moves');
const whiteTimerEl = document.getElementById('whiteTimer');
const blackTimerEl = document.getElementById('blackTimer');
const undoBtn = document.getElementById('undoBtn');
const redoBtn = document.getElementById('redoBtn');

let board = [
    ["r","n","b","q","k","b","n","r"],
    ["p","p","p","p","p","p","p","p"],
    ["","","","","","","",""],
    ["","","","","","","",""],
    ["","","","","","","",""],
    ["","","","","","","",""],
    ["P","P","P","P","P","P","P","P"],
    ["R","N","B","Q","K","B","N","R"]
];

const pieceImages = {
    "P":"https://upload.wikimedia.org/wikipedia/commons/4/45/Chess_plt60.png",
    "R":"https://upload.wikimedia.org/wikipedia/commons/7/72/Chess_rlt60.png",
    "N":"https://upload.wikimedia.org/wikipedia/commons/7/70/Chess_nlt60.png",
    "B":"https://upload.wikimedia.org/wikipedia/commons/b/b1/Chess_blt60.png",
    "Q":"https://upload.wikimedia.org/wikipedia/commons/1/15/Chess_qlt60.png",
    "K":"https://upload.wikimedia.org/wikipedia/commons/4/42/Chess_klt60.png",
    "p":"https://upload.wikimedia.org/wikipedia/commons/c/c7/Chess_pdt60.png",
    "r":"https://upload.wikimedia.org/wikipedia/commons/f/ff/Chess_rdt60.png",
    "n":"https://upload.wikimedia.org/wikipedia/commons/e/ef/Chess_ndt60.png",
    "b":"https://upload.wikimedia.org/wikipedia/commons/9/98/Chess_bdt60.png",
    "q":"https://upload.wikimedia.org/wikipedia/commons/4/47/Chess_qdt60.png",
    "k":"https://upload.wikimedia.org/wikipedia/commons/f/f0/Chess_kdt60.png"
};

// --- Game State ---
let currentTurn = "white";
let draggedPiece = null;
let draggedElement = null;
let moveHistory = [];
let redoStack = [];
let whiteTime = 600;
let blackTime = 600;
let clockInterval = null;

// --- Helpers ---
function isWhite(piece){ return piece && piece===piece.toUpperCase(); }
function isBlack(piece){ return piece && piece===piece.toLowerCase(); }
function formatTime(sec){ const m=Math.floor(sec/60).toString().padStart(2,'0'); const s=(sec%60).toString().padStart(2,'0'); return `${m}:${s}`; }
function updateTimers(){ whiteTimerEl.textContent="White: "+formatTime(whiteTime); blackTimerEl.textContent="Black: "+formatTime(blackTime); }
function startClock(){ clearInterval(clockInterval); clockInterval=setInterval(()=>{ if(currentTurn==="white") whiteTime--; else blackTime--; updateTimers(); if(whiteTime<=0 || blackTime<=0) clearInterval(clockInterval); },1000); }

// --- Draw Board ---
function drawBoard(){
    boardEl.innerHTML="";
    for(let i=0;i<8;i++){
        for(let j=0;j<8;j++){
            const square=document.createElement('div');
            square.className='square '+((i+j)%2===0?'white':'black');
            square.dataset.row=i; square.dataset.col=j;
            boardEl.appendChild(square);

            const piece=board[i][j];
            if(piece){
                const img=document.createElement('img');
                img.src=pieceImages[piece];
                img.className="piece";
                img.dataset.row=i; img.dataset.col=j; img.dataset.type=piece;
                img.style.top=(i*64)+"px"; img.style.left=(j*64)+"px";
                img.addEventListener('mousedown', mouseDown);
                boardEl.appendChild(img);
            }
        }
    }
    updateHistory();
}

function updateHistory(){
    movesList.innerHTML="";
    moveHistory.forEach(m=>{ const li=document.createElement('li'); li.textContent=m; movesList.appendChild(li); });
}

// --- Drag & Drop ---
function mouseDown(e){
    draggedElement = e.target;
    draggedPiece = {row:+draggedElement.dataset.row, col:+draggedElement.dataset.col};
    document.addEventListener("mousemove", mouseMove);
    document.addEventListener("mouseup", mouseUp);
}

function mouseMove(e){
    draggedElement.style.left = e.pageX - boardEl.getBoundingClientRect().left - 32 + "px";
    draggedElement.style.top = e.pageY - boardEl.getBoundingClientRect().top - 32 + "px";
}

function mouseUp(e){
    const col = Math.floor((e.pageX - boardEl.getBoundingClientRect().left)/64);
    const row = Math.floor((e.pageY - boardEl.getBoundingClientRect().top)/64);
    if(row>=0 && row<8 && col>=0 && col<8){
        board[row][col] = board[draggedPiece.row][draggedPiece.col];
        board[draggedPiece.row][draggedPiece.col] = "";
        moveHistory.push(`${board[row][col]}: ${draggedPiece.row},${draggedPiece.col} â†’ ${row},${col}`);
    }
    draggedElement = null;
    draggedPiece = null;
    document.removeEventListener("mousemove", mouseMove);
    document.removeEventListener("mouseup", mouseUp);
    drawBoard();
}

// --- Buttons ---
undoBtn.addEventListener("click", ()=>{ alert("Undo not implemented yet"); });
redoBtn.addEventListener("click", ()=>{ alert("Redo not implemented yet"); });

// --- Init ---
drawBoard();
updateTimers();
startClock();
</script>
</body>
</html>
